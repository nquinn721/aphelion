var mapData = ['[[{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":330},{"type":337},{"type":337},{"type":332},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233}],[{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":330},{"type":337},{"type":337},{"type":332},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233}],[{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":330,"object":41},{"type":337},{"type":337},{"type":332},{"type":233},{"type":233},{"type":233},{"type":286},{"type":266},{"type":266},{"type":266},{"type":266},{"type":266},{"type":266},{"type":266},{"type":287},{"type":233},{"type":233}],[{"type":233},{"type":233},{"type":233,"object":102},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":330},{"type":335},{"type":337},{"type":332},{"type":233},{"type":233},{"type":233},{"type":253},{"type":242},{"type":239},{"type":239},{"type":239},{"type":239},{"type":239},{"type":248},{"type":272},{"type":233},{"type":233}],[{"type":233},{"type":233},{"type":233},{"type":286},{"type":266},{"type":266},{"type":266},{"type":266},{"type":266},{"type":266},{"type":266},{"type":287},{"type":330},{"type":337},{"type":335},{"type":332},{"type":233},{"type":233},{"type":233},{"type":253},{"type":241},{"type":249},{"type":249},{"type":249,"object":66},{"type":249},{"type":249},{"type":243},{"type":272},{"type":233},{"type":233}],[{"type":233},{"type":233},{"type":233},{"type":253},{"type":245},{"type":245},{"type":245},{"type":245},{"type":245},{"type":245},{"type":245},{"type":272},{"type":330},{"type":337},{"type":337},{"type":332},{"type":233},{"type":233},{"type":233},{"type":253},{"type":241},{"type":249},{"type":249},{"type":249},{"type":249},{"type":249},{"type":243},{"type":272},{"type":233},{"type":233}],[{"type":233},{"type":233},{"type":233},{"type":253},{"type":245},{"type":280},{"type":259},{"type":259},{"type":259},{"type":259},{"type":259},{"type":261},{"type":330},{"type":335},{"type":337},{"type":332},{"type":233},{"type":233},{"type":233},{"type":253},{"type":247},{"type":246},{"type":246},{"type":246},{"type":246},{"type":246},{"type":244},{"type":272},{"type":233},{"type":233}],[{"type":233},{"type":233},{"type":233},{"type":253},{"type":245},{"type":272},{"type":233,"object":101},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":330},{"type":337},{"type":335},{"type":332},{"type":233},{"type":233},{"type":233},{"type":285},{"type":259},{"type":259},{"type":259},{"type":279},{"type":245},{"type":280},{"type":259},{"type":261},{"type":233},{"type":233}],[{"type":233},{"type":233},{"type":233},{"type":253},{"type":245},{"type":272},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":330},{"type":337},{"type":337},{"type":332},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":253},{"type":245},{"type":272},{"type":233},{"type":233},{"type":233},{"type":233}],[{"type":233},{"type":233},{"type":233},{"type":253},{"type":245},{"type":272},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233,"object":68},{"type":233},{"type":330},{"type":337},{"type":337},{"type":332},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":253},{"type":245},{"type":272},{"type":233},{"type":233},{"type":233},{"type":233}],[{"type":233},{"type":233},{"type":233},{"type":253},{"type":245},{"type":272},{"type":233},{"type":233},{"type":233,"object":12},{"type":233},{"type":233},{"type":233},{"type":330},{"type":338},{"type":337},{"type":332},{"type":233},{"type":233},{"type":233,"object":27},{"type":233},{"type":233,"object":101},{"type":233},{"type":233},{"type":253},{"type":245},{"type":272},{"type":233},{"type":233},{"type":233,"object":97},{"type":233}],[{"type":233},{"type":233},{"type":233},{"type":253},{"type":245},{"type":272},{"type":233},{"type":233},{"type":233},{"type":233},{"type":322},{"type":331},{"type":326},{"type":338},{"type":338},{"type":327},{"type":331,"object":266},{"type":323},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":253},{"type":245},{"type":272},{"type":233},{"type":233},{"type":233},{"type":233}],[{"type":233},{"type":233},{"type":233},{"type":285},{"type":259},{"type":261},{"type":233},{"type":233},{"type":233},{"type":233,"object":29},{"type":330},{"type":338},{"type":338},{"type":335},{"type":338},{"type":335},{"type":338},{"type":332},{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":285},{"type":259},{"type":261},{"type":233},{"type":233},{"type":233},{"type":233}],[{"type":331},{"type":331},{"type":331},{"type":331,"object":38},{"type":331},{"type":331},{"type":331},{"type":331},{"type":331},{"type":331},{"type":326},{"type":338},{"type":338},{"type":335},{"type":338},{"type":338},{"type":338},{"type":327},{"type":331},{"type":331},{"type":331},{"type":331},{"type":331},{"type":331},{"type":331},{"type":331},{"type":331},{"type":331},{"type":331},{"type":331}],[{"type":337},{"type":337},{"type":337},{"type":338},{"type":338},{"type":338},{"type":335},{"type":335},{"type":338},{"type":338},{"type":338},{"type":338},{"type":338},{"type":338},{"type":338},{"type":337},{"type":335},{"type":338},{"type":338},{"type":338},{"type":335},{"type":338},{"type":338},{"type":338},{"type":338},{"type":338},{"type":335},{"type":338},{"type":335},{"type":338}],[{"type":337},{"type":337},{"type":337},{"type":337},{"type":338},{"type":338},{"type":338},{"type":338},{"type":335},{"type":335},{"type":338},{"type":335},{"type":338},{"type":338},{"type":338,"object":34},{"type":338},{"type":338},{"type":338},{"type":338},{"type":338},{"type":338},{"type":335},{"type":335},{"type":338},{"type":338},{"type":335},{"type":338,"object":235},{"type":335},{"type":338},{"type":338}],[{"type":333},{"type":333},{"type":333},{"type":333},{"type":333},{"type":333},{"type":333},{"type":333},{"type":333},{"type":333},{"type":325},{"type":338},{"type":335},{"type":338},{"type":338},{"type":336},{"type":338},{"type":328},{"type":333},{"type":333},{"type":333},{"type":333},{"type":333},{"type":333},{"type":333},{"type":333},{"type":333},{"type":333},{"type":333},{"type":333}],[{"type":266},{"type":266},{"type":266},{"type":266},{"type":266},{"type":266},{"type":266},{"type":266},{"type":266},{"type":287},{"type":330},{"type":338},{"type":338},{"type":335},{"type":336},{"type":338},{"type":338},{"type":332},{"type":286},{"type":266},{"type":266},{"type":266},{"type":266},{"type":266},{"type":266},{"type":266},{"type":266},{"type":266},{"type":266},{"type":266}],[{"type":245},{"type":245},{"type":245},{"type":245},{"type":245},{"type":245},{"type":245},{"type":245},{"type":245},{"type":272},{"type":321},{"type":333},{"type":325},{"type":338},{"type":336},{"type":328},{"type":333},{"type":324},{"type":253},{"type":245},{"type":245},{"type":245},{"type":245},{"type":245},{"type":245},{"type":245},{"type":245},{"type":245},{"type":245},{"type":245}],[{"type":239},{"type":239},{"type":239},{"type":239},{"type":239},{"type":239},{"type":239},{"type":248},{"type":245},{"type":277},{"type":266},{"type":287},{"type":330},{"type":336},{"type":336},{"type":332},{"type":286},{"type":266},{"type":278},{"type":242},{"type":239},{"type":239},{"type":239},{"type":248},{"type":245},{"type":245},{"type":242},{"type":239},{"type":239},{"type":239}],[{"type":249},{"type":249},{"type":249},{"type":249},{"type":249},{"type":249},{"type":249},{"type":243},{"type":245,"object":26},{"type":245},{"type":245},{"type":272},{"type":330},{"type":335},{"type":336},{"type":332},{"type":253},{"type":245},{"type":245},{"type":240},{"type":249},{"type":249},{"type":249},{"type":243},{"type":245},{"type":245},{"type":241},{"type":249},{"type":249},{"type":249}],[{"type":249},{"type":249},{"type":249},{"type":249},{"type":249},{"type":249},{"type":249},{"type":281},{"type":239},{"type":248},{"type":245},{"type":272},{"type":330},{"type":336},{"type":336},{"type":332},{"type":253},{"type":245},{"type":242},{"type":282},{"type":249},{"type":249},{"type":249},{"type":243},{"type":245},{"type":245},{"type":241},{"type":249},{"type":249},{"type":249}],[{"type":246},{"type":246},{"type":246},{"type":283},{"type":249},{"type":249},{"type":249},{"type":249},{"type":249},{"type":243},{"type":245},{"type":272},{"type":330},{"type":336},{"type":336},{"type":332},{"type":253},{"type":245},{"type":241},{"type":249},{"type":249},{"type":249},{"type":284},{"type":244},{"type":245},{"type":245},{"type":247},{"type":283},{"type":249},{"type":249}],[{"type":259},{"type":259},{"type":279},{"type":247},{"type":246},{"type":283},{"type":249},{"type":249},{"type":249},{"type":243},{"type":245},{"type":272},{"type":330},{"type":336},{"type":336},{"type":332},{"type":253},{"type":245},{"type":241},{"type":249},{"type":249},{"type":249,"object":237},{"type":243},{"type":245},{"type":245},{"type":245},{"type":245},{"type":241},{"type":249},{"type":249}],[{"type":233},{"type":233},{"type":285},{"type":259},{"type":279},{"type":240},{"type":249},{"type":249},{"type":249},{"type":243},{"type":245},{"type":272},{"type":330},{"type":336},{"type":335},{"type":332},{"type":253},{"type":245},{"type":241},{"type":249},{"type":249},{"type":249},{"type":243},{"type":245},{"type":245},{"type":245},{"type":245},{"type":241},{"type":249},{"type":249}],[{"type":233},{"type":233},{"type":233},{"type":233},{"type":253},{"type":247},{"type":283},{"type":249},{"type":249},{"type":243},{"type":245},{"type":272},{"type":330},{"type":336},{"type":336},{"type":332},{"type":253},{"type":245},{"type":241},{"type":249},{"type":249},{"type":249},{"type":243},{"type":245},{"type":245},{"type":245},{"type":245},{"type":241},{"type":249},{"type":249}],[{"type":233},{"type":233},{"type":233},{"type":233},{"type":285},{"type":279},{"type":240},{"type":249},{"type":249},{"type":243},{"type":245},{"type":272},{"type":330},{"type":337},{"type":337},{"type":332},{"type":253},{"type":245},{"type":241},{"type":249},{"type":249},{"type":249},{"type":243},{"type":245},{"type":245},{"type":245,"object":238},{"type":245},{"type":241},{"type":249},{"type":249}],[{"type":233},{"type":233},{"type":233,"object":222},{"type":233},{"type":233,"object":29},{"type":253},{"type":240},{"type":249},{"type":249},{"type":243},{"type":245},{"type":272},{"type":330},{"type":337},{"type":337},{"type":332},{"type":253},{"type":245},{"type":241},{"type":249},{"type":249},{"type":249},{"type":243},{"type":245},{"type":245},{"type":245},{"type":245},{"type":241},{"type":249},{"type":249}],[{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":253},{"type":240},{"type":249},{"type":249},{"type":243},{"type":245},{"type":272},{"type":330},{"type":337},{"type":337},{"type":332},{"type":253},{"type":245},{"type":241},{"type":249},{"type":249},{"type":249},{"type":281},{"type":239},{"type":239},{"type":239},{"type":239},{"type":282},{"type":249},{"type":249}],[{"type":233},{"type":233},{"type":233},{"type":233},{"type":233},{"type":253},{"type":240},{"type":249},{"type":249},{"type":243},{"type":245},{"type":272},{"type":330},{"type":337},{"type":337},{"type":332},{"type":253},{"type":245},{"type":241},{"type":249},{"type":249},{"type":249},{"type":249},{"type":249},{"type":249},{"type":249},{"type":249},{"type":249},{"type":249},{"type":249}]]', '[[{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380}],[{"type":380},{"type":218,"object":159},{"type":218,"object":164},{"type":218,"object":164},{"type":218,"object":164},{"type":218,"object":164},{"type":218,"object":164},{"type":218,"object":164},{"type":218,"object":164},{"type":218,"object":164},{"type":218,"object":164},{"type":218,"object":164},{"type":218,"object":164},{"type":218,"object":164},{"type":218,"object":164},{"type":218,"object":164},{"type":211,"object":161},{"type":380},{"type":380},{"type":380}],[{"type":380},{"type":218,"object":157},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218,"object":162},{"type":380},{"type":380},{"type":380}],[{"type":380},{"type":218,"object":157},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218,"object":162},{"type":380},{"type":380},{"type":380}],[{"type":380},{"type":218,"object":157},{"type":218},{"type":218},{"type":218,"object":170},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218,"object":162},{"type":380},{"type":380},{"type":380}],[{"type":380},{"type":218,"object":157},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218,"object":162},{"type":380},{"type":380},{"type":380}],[{"type":380},{"type":218,"object":157},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218,"object":162},{"type":380},{"type":380},{"type":380}],[{"type":380},{"type":218,"object":157},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218,"object":170},{"type":218},{"type":218},{"type":218,"object":162},{"type":380},{"type":380},{"type":380}],[{"type":380},{"type":218,"object":157},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218,"object":162},{"type":380},{"type":380},{"type":380}],[{"type":380},{"type":218,"object":157},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218,"object":162},{"type":380},{"type":210},{"type":215}],[{"type":380},{"type":218,"object":157},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218},{"type":218,"object":162},{"type":380},{"type":214},{"type":218}],[{"type":380},{"type":212,"object":158},{"type":218,"object":163},{"type":218,"object":163},{"type":218,"object":163},{"type":218,"object":163},{"type":218,"object":163},{"type":218,"object":163},{"type":218,"object":163},{"type":218,"object":163},{"type":218,"object":163},{"type":218,"object":163},{"type":218,"object":163},{"type":218,"object":163},{"type":218,"object":163},{"type":218,"object":163},{"type":218,"object":160},{"type":380},{"type":212},{"type":216}],[{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380}],[{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380}],[{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380}],[{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380},{"type":380}],[{"type":380},{"type":380,"object":480},{"type":380},{"type":380,"object":154},{"type":218},{"type":380,"object":154},{"type":218},{"type":380,"object":154},{"type":218},{"type":380,"object":154},{"type":218},{"type":380,"object":154},{"type":218},{"type":380,"object":154},{"type":218},{"type":380,"object":154},{"type":380},{"type":380,"object":481},{"type":380},{"type":380}],[{"type":380},{"type":380},{"type":380},{"type":380,"object":154},{"type":218},{"type":380,"object":154},{"type":218},{"type":380,"object":154},{"type":218},{"type":380,"object":154},{"type":218},{"type":380,"object":154},{"type":218},{"type":380,"object":154},{"type":218},{"type":380,"object":154},{"type":380},{"type":380},{"type":380},{"type":380}],[{"type":380},{"type":380},{"type":380},{"type":380,"object":154},{"type":218},{"type":380,"object":154},{"type":218},{"type":380,"object":154},{"type":218},{"type":380,"object":154},{"type":218},{"type":380,"object":154},{"type":218},{"type":380,"object":154},{"type":218},{"type":380,"object":154},{"type":380},{"type":380},{"type":380},{"type":380}],[{"type":380},{"type":380},{"type":380},{"type":380,"object":154},{"type":218},{"type":380,"object":154},{"type":218},{"type":380,"object":154},{"type":218},{"type":380,"object":154},{"type":218},{"type":380,"object":154},{"type":218},{"type":380,"object":154},{"type":218},{"type":380,"object":154},{"type":380},{"type":380},{"type":380},{"type":380}]]'];

function Map(w, h, id) {
	this.width = w;
	this.height = h;
	this.players = [];
	this.monsters = []; //[new Monster('trickster.png', this, rand(0, w - 1), rand(0, h - 1), 3)];
	this.id = id;
	this.mapData = JSON.parse(mapData[id]);
}

Map.prototype.pointOnMap = function(x, y) {
	return (x >= 0 && y >= 0 && x < this.width && y < this.height);
}

Map.prototype.pointIsWalkable = function(x, y) {
	return this.pointOnMap(x, y) && !this.objectOnPoint(x, y);
}

Map.prototype.objectOnPoint = function(x, y) {
	var playersAndObjects = this.players.concat(this.monsters);
	for(var i = 0;i < playersAndObjects.length;++i) {
		if(playersAndObjects[i].x == x && playersAndObjects[i].y == y) {
			return true;
		}
	}
	if(this.mapData[y][x].object !== undefined) {
		return true;
	}
	return false;
}

Map.prototype.addPlayer = function(p) {
	this.players.push(p);
}

Map.prototype.addMonster = function(m) {
	this.monsters.push(m);
}

Map.prototype.monsterAtPoint = function(x, y) {
	for(var i = 0;i < this.monsters.length;++i) {
		if(this.monsters[i].x == x && this.monsters[i].y == y) {
			return this.monsters[i];
		}
	}
	return false;
}

Map.prototype.playerAtPoint = function(x, y) {
	for(var i = 0;i < this.players.length;++i) {
		if(this.players[i].x == x && this.players[i].y == y) {
			return this.players[i];
		}
	}
	return false;
}

Map.prototype.playerData = function() {
	var pdata = [];
	for(var i = 0;i < this.players.length;++i) {
		if(!this.players[i].hasInit) {
			continue;
		}
		pdata.push(this.players[i].data());
	}
	return pdata;
}

Map.prototype.monsterData = function() {
	var mdata = [];
	for(var i = 0;i < this.monsters.length;++i) {
		mdata.push(this.monsters[i].data());
	}
	return mdata;
}

Map.prototype.removePlayer = function(p) {
	for(var i = 0;i < this.players.length;++i) {
		if(this.players[i] == p) {
			this.players.splice(i, 1);
		}
	}
}

function Map(w, h, id) {
	this.width = w;
	this.height = h;
	this.players = [];
	this.monsters = []; //[new Monster('trickster.png', this, rand(0, w - 1), rand(0, h - 1), 3)];
	this.id = id;
	this.mapData = JSON.parse(mapData[id]);
}

Map.prototype.pointOnMap = function(x, y) {
	return (x >= 0 && y >= 0 && x < this.width && y < this.height);
}

Map.prototype.pointIsWalkable = function(x, y) {
	return this.pointOnMap(x, y) && !this.objectOnPoint(x, y);
}

Map.prototype.objectOnPoint = function(x, y) {
	var playersAndObjects = this.players.concat(this.monsters);
	for(var i = 0;i < playersAndObjects.length;++i) {
		if(playersAndObjects[i].x == x && playersAndObjects[i].y == y) {
			return true;
		}
	}
	if(this.mapData[y][x].object !== undefined) {
		return true;
	}
	return false;
}

Map.prototype.addPlayer = function(p) {
	this.players.push(p);
}

Map.prototype.addMonster = function(m) {
	this.monsters.push(m);
}

Map.prototype.monsterAtPoint = function(x, y) {
	for(var i = 0;i < this.monsters.length;++i) {
		if(this.monsters[i].x == x && this.monsters[i].y == y) {
			return this.monsters[i];
		}
	}
	return false;
}

Map.prototype.playerAtPoint = function(x, y) {
	for(var i = 0;i < this.players.length;++i) {
		if(this.players[i].x == x && this.players[i].y == y) {
			return this.players[i];
		}
	}
	return false;
}

Map.prototype.playerData = function() {
	var pdata = [];
	for(var i = 0;i < this.players.length;++i) {
		if(!this.players[i].hasInit) {
			continue;
		}
		pdata.push(this.players[i].data());
	}
	return pdata;
}

Map.prototype.monsterData = function() {
	var mdata = [];
	for(var i = 0;i < this.monsters.length;++i) {
		mdata.push(this.monsters[i].data());
	}
	return mdata;
}

Map.prototype.removePlayer = function(p) {
	for(var i = 0;i < this.players.length;++i) {
		if(this.players[i] == p) {
			this.players.splice(i, 1);
		}
	}
}

module.exports.Map = Map;
module.exports.mapData = mapData;